"use strict";(self.webpackChunkwhg_training_resources=self.webpackChunkwhg_training_resources||[]).push([[6967],{3905:function(e,t,a){a.d(t,{Zo:function(){return p},kt:function(){return d}});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),u=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},p=function(e){var t=u(e.components);return n.createElement(l.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),c=u(a),d=r,g=c["".concat(l,".").concat(d)]||c[d]||h[d]||o;return a?n.createElement(g,i(i({ref:t},p),{},{components:a})):n.createElement(g,i({ref:t},p))}));function d(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,i=new Array(o);i[0]=c;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var u=2;u<o;u++)i[u]=a[u];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"},1103:function(e,t,a){a.r(t),a.d(t,{assets:function(){return p},contentTitle:function(){return l},default:function(){return d},frontMatter:function(){return s},metadata:function(){return u},toc:function(){return h}});var n=a(7462),r=a(3366),o=(a(7294),a(3905)),i=["components"],s={},l="Exploring Reads in IGV",u={unversionedId:"next_generation_sequencing/IGV/Exploring_reads_in_IGV",id:"next_generation_sequencing/IGV/Exploring_reads_in_IGV",title:"Exploring Reads in IGV",description:"Contributors: Annie Forster, Gavin Band",source:"@site/docs/next_generation_sequencing/IGV/Exploring_reads_in_IGV.md",sourceDirName:"next_generation_sequencing/IGV",slug:"/next_generation_sequencing/IGV/Exploring_reads_in_IGV",permalink:"/whg-training-resources/next_generation_sequencing/IGV/Exploring_reads_in_IGV",draft:!1,editUrl:"https://github.com/whg-training/whg-training-resources/docs/next_generation_sequencing/IGV/Exploring_reads_in_IGV.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Visualising alignments",permalink:"/whg-training-resources/next_generation_sequencing/IGV/"},next:{title:"LICENSE",permalink:"/whg-training-resources/LICENSE"}},p={},h=[{value:"Getting started",id:"getting-started",level:2},{value:"Looking at reads.",id:"looking-at-reads",level:2},{value:"Looking at SNPs",id:"looking-at-snps",level:2},{value:"Looking at insertions and deletions",id:"looking-at-insertions-and-deletions",level:2},{value:"The trouble with mapping is...",id:"the-trouble-with-mapping-is",level:2},{value:"Examining larger structural variants",id:"examining-larger-structural-variants",level:2},{value:"Examining structural variant breakpoints",id:"examining-structural-variant-breakpoints",level:2},{value:"Figuring out the structural variant structure",id:"figuring-out-the-structural-variant-structure",level:2},{value:"Summary",id:"summary",level:2}],c={toc:h};function d(e){var t=e.components,a=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"exploring-reads-in-igv"},"Exploring Reads in IGV"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Contributors:")," Annie Forster, Gavin Band"),(0,o.kt)("h2",{id:"getting-started"},"Getting started"),(0,o.kt)("p",null,"In this tutorial you are going to be inspecting the alignments you have created in a program called Integrative Genomics Viewer (IGV). IGV is a very handy piece of software which allows you to visually inspect alignments across the genome. "),(0,o.kt)("p",null,"First you will need to download IGV. You can find the software ",(0,o.kt)("a",{parentName:"p",href:"https://software.broadinstitute.org/software/igv/download"},"here.")),(0,o.kt)("p",null,"Next load one of your bam files. You will be prompted to download the appropriate reference; \u201cPfalciparum3D7\u201d should already be available from the provided selection.  For this tutorial you should load (at least):"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"QG0033-C.bam")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"QG0041-C.bam"))),(0,o.kt)("p",null,"(You are also welcome to load the other three.)"),(0,o.kt)("p",null,"If you followed the snakemake tutorial, you should also be able to load:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Your coverage (",(0,o.kt)("inlineCode",{parentName:"li"},".bedgraph"),") files for the above samples (this isn't very important because IGV shows you coverage anyway.)"),(0,o.kt)("li",{parentName:"ul"},"Your ",(0,o.kt)("inlineCode",{parentName:"li"},"variants.vcf.gz")," file containing the variant calls from Octopus.  (If yours doesn't work, this may be due to an Octopus issue that has now been fixed.  I filtered out the problem variants in ",(0,o.kt)("a",{parentName:"li",href:"https://www.well.ox.ac.uk/~gav/projects/gms/statistics-course/Next_Generation_Sequencing/practicals/ngs_processing_pipeline/solutions/results/variants/"},"my version")," - feel free to download this one.)")),(0,o.kt)("p",null,"Load these in now.  Here are a few things to try:"),(0,o.kt)("h2",{id:"looking-at-reads"},"Looking at reads."),(0,o.kt)("p",null,"To see reads you will need to zoom into a location on the genome.  For example, let's zoom into the gene that harbours the famous chloroquine resistance mutation, ",(0,o.kt)("a",{parentName:"p",href:"https://plasmodb.org/plasmo/app/record/gene/PF3D7_0709000"},"Chloroquine resistance transporter (",(0,o.kt)("em",{parentName:"a"},"CRT"),")"),".  To search for it you will need its ID, which is ",(0,o.kt)("inlineCode",{parentName:"p"},"PF3D7_0709000"),".  Voila!  Some reads."),(0,o.kt)("p",null,"IGV has lots of options that let you visualise reads in different ways.  Here are some things to try (most available by right-clicking on the reads panel)."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"These reads are from paired-end sequencing.  If you right-click and choose 'view as pairs', IGV will show you this structure."),(0,o.kt)("li",{parentName:"ul"},"Often there are too many reads to see.  Try using 'squished' mode to squish them up."),(0,o.kt)("li",{parentName:"ul"},"On the other hand the ",(0,o.kt)("inlineCode",{parentName:"li"},"genes")," track can be annoying when it is squished.  Right-click and choose 'expanded' to see the genes.")),(0,o.kt)("h2",{id:"looking-at-snps"},"Looking at SNPs"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Question.")," The mutation that causes ",(0,o.kt)("a",{parentName:"p",href:"https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2954758/"},"chloroquine resistance")," is ",(0,o.kt)("inlineCode",{parentName:"p"},"CRT K76>T"),", at ",(0,o.kt)("inlineCode",{parentName:"p"},"Pf3D7_07_v3:403,625"),".  (It actually involves a small haplotype including other nearby mutations).  "),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Can you find these mutations?")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Parasites with the non-reference allele are resistant to chloroquine - are your parasites resistant or susceptible?  (NB. all these samples come from ",(0,o.kt)("a",{parentName:"p",href:"https://www.google.com/maps/place/Democratic+Republic+of+the+Congo/@-3.9835365,12.6862829,5z/data=!3m1!4b1!4m5!3m4!1s0x1979facf9a7546bd:0x4c63e5eac93f141!8m2!3d-4.038333!4d21.758664"},"Democratic Republic of The Congo"),").")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Zoom into this location to look at the sequence.  Can you figure out the amino acid change(s)?")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"How many reads support this in each sample?  What alleles do they carry?  What are their IDs?  Are they well mapped?  Are they properly paired?  Where is their pair?"))),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Note.")," By default you are looking at all reads (including those that didn't map very well.)  There's an option hidden away under ",(0,o.kt)("inlineCode",{parentName:"p"},"Preferences")," -> ",(0,o.kt)("inlineCode",{parentName:"p"},"Alignment")," that lets you set a mapping quality threshold.  A good default value to put here is 20 (but remember that by doing this you are filtering some reads!)"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Note.")," 'properly paired' means that the two reads in the pair align to the same region in the right orientation, and roughly fall within the distribution of insert sizes inferred from all the read pairs in the data.  The aligner (",(0,o.kt)("inlineCode",{parentName:"p"},"bwa")," in this case) sets a flag in the BAM file to reflect this."),(0,o.kt)("h2",{id:"looking-at-insertions-and-deletions"},"Looking at insertions and deletions"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Question.")," The variants above are single nucleotide polymorphisms (SNPs) - or rather multiple nucleotide polymorphisms (MNPs) since several come together.  What about other types of variation?  Scroll around a bit and see if you can find a deletion.  (If stuck, try looking around the gene ",(0,o.kt)("a",{parentName:"p",href:"https://plasmodb.org/plasmo/app/search?q=PF3D7_0220300"},(0,o.kt)("inlineCode",{parentName:"a"},"PF3D7_0215300")),".  What read evidence supports this deletion?"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Note.")," There might also be insertions, which are denoted by a purple bar across a read in IGV.  Can you find any of these?"),(0,o.kt)("h2",{id:"the-trouble-with-mapping-is"},"The trouble with mapping is..."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Question.")," If you scroll around a bit, after a while you'll come across regions where no reads (or very few reads) seem to align.  Can you find one?  What could cause this? "),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Hint.")," Try searching for the relevant piece of genome sequence using ",(0,o.kt)("a",{parentName:"p",href:"https://blast.ncbi.nlm.nih.gov/Blast.cgi"},"NCBI BLAST"),".  For example, I tried this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$ samtools faidx data/reference/Pf3D7_v3.fa.gz Pf3D7_07_v3:343,180-343,380\n>Pf3D7_07_v3:343,180-343,380\ntatatatatatatatatatatatatatatatatatatataaatatatatatatgtatgta\ntgtatgtaatattttagtgcaaaaaaaaaaaaaaaaaaaaaaaaaaagtatataatgaaa\naattattatatatatatatattatatatatatatatatatatatatatatatatatatat\natatatatatatatatatata\n")),(0,o.kt)("p",null,"and then pasted the above into the ",(0,o.kt)("a",{parentName:"p",href:"https://blast.ncbi.nlm.nih.gov/Blast.cgi"},"Nucleotide BLAST page"),".  (Another version of this can be found ",(0,o.kt)("a",{parentName:"p",href:"https://plasmodb.org/plasmo/app/search/transcript/UnifiedBlast"},"on PlasmoDB"),".  ",(0,o.kt)("strong",{parentName:"p"},"Note.")," you may need to turn off the 'low complexity region' filter to get useful results."),(0,o.kt)("h2",{id:"examining-larger-structural-variants"},"Examining larger structural variants"),(0,o.kt)("p",null,"Let's have a look at a larger structural variant.  Zoom your IGV to the region around the gene ",(0,o.kt)("a",{parentName:"p",href:"https://plasmodb.org/plasmo/app/record/gene/PF3D7_1127000"},(0,o.kt)("inlineCode",{parentName:"a"},"Pf3D7_1127000")),".  And zoom out a bit so you can see the whole region including the two flanking genes."),(0,o.kt)("p",null,"The samples from this tutorial were chosen because some of them contain a large structural variant in this region. "),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Challenge.")," Can you find this structural variant in one or more of the samples you've loaded?"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Hints.")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"One way to find structural variants is by looking at their effects on copy number (i.e. on read coverage.)  Do any samples have unusual copy number profiles?  (NB. this is generally easier in human sequence data because in P.falciparum the coverage varies a lot anyway due to varying AT content.)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Your reads are paired-end reads.  If the genome has a different structure to the reference, then these might not align close together in the right orientation or insert size.  Can you find reads like this?  (Hint: the 'view as pairs', 'group by' and/or 'color by' options are very useful here.)  What is their orientation - are the read pairs the 'right' way round or the 'wrong' way round?  What does this mean?  Are these single reads or are they supported by others?"))),(0,o.kt)("h2",{id:"examining-structural-variant-breakpoints"},"Examining structural variant breakpoints"),(0,o.kt)("p",null,"By a 'breakpoint' we mean the points where the segments of the sequenced genome are connected together in a different way to the reference genome.  The long, wrongly oriented / wrong insert size reads above potentially span these breakpoints."),(0,o.kt)("p",null,"A good way to look at this is as follows.  First zoom into one of the reads in the pair. Now right-click on a read and choose 'View mate region in split screen'.  Voila!  You are now looking at both ends of the same read pair."),(0,o.kt)("p",null,"To take this further there is an additional option.  If the read in the pair actually crosses a structural variant breakpoint, it could be that the end of the read does not align well.  If so it will typically be 'soft-clipped' by the aligner.  (The ",(0,o.kt)("a",{parentName:"p",href:"https://sites.google.com/site/bioinformaticsremarks/bioinfo/sam-bam-format/what-is-a-cigar"},(0,o.kt)("inlineCode",{parentName:"a"},"CIGAR string"))," for the alignment will have a sequence of 'S's at the end).  Under ",(0,o.kt)("inlineCode",{parentName:"p"},"Preferences")," -> ",(0,o.kt)("inlineCode",{parentName:"p"},"Alignments")," there is an option 'Show soft-clipped bases' to visualise these.  Go and turn this on.  Does this help figure out the basepair location of the possible breakpoint?"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"NB.")," In the current data this works best for the reads at ",(0,o.kt)("inlineCode",{parentName:"p"},"Pf3D7_11_v3:1,058,745-1,058,915")," - if you processed the full coverage data then it might work at all the breakpoints."),(0,o.kt)("h2",{id:"figuring-out-the-structural-variant-structure"},"Figuring out the structural variant structure"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Extra hard challenge.")," Can you figure out the structure of the structural variant genomes from these reads?"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Warning.")," This really is hard!  If you want some inspiration, see Figure 6 of ",(0,o.kt)("a",{parentName:"p",href:"https://doi.org/10.1126/science.aam6393"},"this paper on the Dantu blood group")," to see a similar process applied to a human structural variant."),(0,o.kt)("h2",{id:"summary"},"Summary"),(0,o.kt)("p",null,"Congratulations!  You are now an IGV expert!"))}d.isMDXComponent=!0}}]);