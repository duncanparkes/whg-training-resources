"use strict";(self.webpackChunkwhg_training_resources=self.webpackChunkwhg_training_resources||[]).push([[9883],{3905:function(e,n,t){t.d(n,{Zo:function(){return c},kt:function(){return m}});var r=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var g=r.createContext({}),u=function(e){var n=r.useContext(g),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},c=function(e){var n=u(e.components);return r.createElement(g.Provider,{value:n},e.children)},l={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},p=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,g=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=u(t),m=o,f=p["".concat(g,".").concat(m)]||p[m]||l[m]||a;return t?r.createElement(f,i(i({ref:n},c),{},{components:t})):r.createElement(f,i({ref:n},c))}));function m(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,i=new Array(a);i[0]=p;var s={};for(var g in n)hasOwnProperty.call(n,g)&&(s[g]=n[g]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var u=2;u<a;u++)i[u]=t[u];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}p.displayName="MDXCreateElement"},6840:function(e,n,t){t.r(n),t.d(n,{assets:function(){return c},contentTitle:function(){return g},default:function(){return m},frontMatter:function(){return s},metadata:function(){return u},toc:function(){return l}});var r=t(7462),o=t(3366),a=(t(7294),t(3905)),i=["components"],s={sidebar_position:10},g=void 0,u={unversionedId:"programming/programming_with_gene_annotations/Getting_sequence_lengths",id:"programming/programming_with_gene_annotations/Getting_sequence_lengths",title:"Getting_sequence_lengths",description:"Up to table of contents",source:"@site/docs/programming/programming_with_gene_annotations/Getting_sequence_lengths.md",sourceDirName:"programming/programming_with_gene_annotations",slug:"/programming/programming_with_gene_annotations/Getting_sequence_lengths",permalink:"/whg-training-resources/programming/programming_with_gene_annotations/Getting_sequence_lengths",draft:!1,editUrl:"https://github.com/whg-training/whg-training-resources/docs/programming/programming_with_gene_annotations/Getting_sequence_lengths.md",tags:[],version:"current",sidebarPosition:10,frontMatter:{sidebar_position:10},sidebar:"tutorialSidebar",previous:{title:"Counting_genes_3",permalink:"/whg-training-resources/programming/programming_with_gene_annotations/Counting_genes_3"},next:{title:"How_much_of_the_genome_is_in_genes",permalink:"/whg-training-resources/programming/programming_with_gene_annotations/How_much_of_the_genome_is_in_genes"}},c={},l=[{value:"Getting sequence lengths",id:"getting-sequence-lengths",level:2}],p={toc:l};function m(e){var n=e.components,s=(0,o.Z)(e,i);return(0,a.kt)("wrapper",(0,r.Z)({},p,s,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"/whg-training-resources/programming/programming_with_gene_annotations/"},"Up to table of contents")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"/whg-training-resources/programming/programming_with_gene_annotations/Counting_genes_3"},"Back to the previous page")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"/whg-training-resources/programming/programming_with_gene_annotations/How_much_of_the_genome_is_in_genes"},"Go to the next page")),(0,a.kt)("h2",{id:"getting-sequence-lengths"},"Getting sequence lengths"),(0,a.kt)("p",null,"To answer questions like 'how much of the genome is in genes' we need to know what the length of each genome is.\nHappily, if you look at the ",(0,a.kt)("a",{parentName:"p",href:"http://ftp.ensembl.org/pub/current_gff3/"},"GFF files on Ensembl")," the sequences from the\nrelevant reference are listed in the metadata. For example, for humans they look like this:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"##gff-version 3\n##sequence-region   1 1 248956422\n##sequence-region   10 1 133797422\n##sequence-region   11 1 135086622\n##sequence-region   12 1 133275309\n...\n##sequence-region   7 1 159345973\n##sequence-region   8 1 145138636\n##sequence-region   9 1 138394717\n##sequence-region   MT 1 16569\n##sequence-region   X 1 156040895\n##sequence-region   Y 2752083 56887902\n")),(0,a.kt)("p",null,"The three pieces of data on each row are: the sequence name (first column), the sequence starting position, and the\nending position. (Incidentally, the reason the Y chromosome starts at a base different than 1 is because it omits the\n",(0,a.kt)("a",{parentName:"p",href:"https://www.ncbi.nlm.nih.gov/grc/human?filters=chr:Y#current-regions"},"pseudoautosomal regions"),", which are often\ntreated for analysis purposes as being on the X chromosome)."),(0,a.kt)("p",null,"If you feel like it, please try the following:"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Challenge:")," write a function ",(0,a.kt)("inlineCode",{parentName:"p"},"parse_sequences_from_gff_metadata()")," that"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"takes the gff filename as argument"),(0,a.kt)("li",{parentName:"ul"},"return a pandas dataframe with the above information.  It should have three columns, the ",(0,a.kt)("inlineCode",{parentName:"li"},"sequence"),", the ",(0,a.kt)("inlineCode",{parentName:"li"},"start"),", and the ",(0,a.kt)("inlineCode",{parentName:"li"},"end"),".")),(0,a.kt)("p",null,"Use this function in ",(0,a.kt)("inlineCode",{parentName:"p"},"gff_to_sqlite.py")," so that it records sequence lengths into the output\ndatabase as well."),(0,a.kt)("p",null,"Here's a test case:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"import unittest\n\nclass TestGff(unittest.TestCase):\n    def test_parse_sequences_from_gff_metadata():\n       import io\n       test_data = \"\"\"##gff-version 3\n##sequence-region   1 1 248956422\n##sequence-region   10 1 133797422\n1       GRCh38  chromosome      1       248956422       .       .       .       ID=chromosome:1;Alias=CM000663.2,chr1,NC_000001.11\n\"\"\"\n\n       sequences = parse_sequences_from_gff_metadata( io.StringIO( test_data ))\n\n       self.assertEqual( sequences['sequence'][0], '1' )\n       self.assertEqual( sequences['sequence'][0], '10' )\n       self.assertEqual( sequences['start'][1], 1 )\n       self.assertEqual( sequences['start'][0], 1 )\n       self.assertEqual( sequences['end'][0], 248956422 )\n       self.assertEqual( sequences['end'][1], 133797422 )\n")),(0,a.kt)("p",null,"If you want some hints or just don't fancy writing this piece of sequence parsing code - feel free\nto look at ",(0,a.kt)("a",{parentName:"p",href:"solutions/part3/gff.py"},"my version is here"),". And I added it to\n",(0,a.kt)("a",{target:"_blank",href:t(3430).Z},(0,a.kt)("code",null,"gff_to_sqlite.py")),"."),(0,a.kt)("p",null,"We are now ready to ",(0,a.kt)("a",{parentName:"p",href:"/whg-training-resources/programming/programming_with_gene_annotations/How_much_of_the_genome_is_in_genes"},"figure out how much of the genome is in genes"),"."))}m.isMDXComponent=!0},3430:function(e,n,t){n.Z=t.p+"assets/files/gff_to_sqlite-c1f539a11fe960fd60bff924d1e22a37.py"}}]);